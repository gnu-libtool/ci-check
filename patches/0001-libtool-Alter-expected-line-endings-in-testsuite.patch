From 670f0fd33882d892da3098270101238964e8cdeb Mon Sep 17 00:00:00 2001
From: Ileana Dumitrescu <ileanadumitrescu95@gmail.com>
Date: Mon, 7 Apr 2025 19:55:23 +0300
Subject: [PATCH] libtool: Alter expected line endings in testsuite

When comparing expected output in LT_AT_CHECK_EXECUTE, several tests
fail with mismatched line endings. This patch should fix Windows
environments that have CRLF text line endings disabled and only use
the LF character for line endings.

* tests/testsuite.at: Removed '\r' from awk's printf command.
---
 tests/testsuite.at | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/tests/testsuite.at b/tests/testsuite.at
index c5c85ec0..8660ab5b 100644
--- a/tests/testsuite.at
+++ b/tests/testsuite.at
@@ -271,8 +271,11 @@ AT_CHECK([test -z "$leftovers"])
 # Ensure correct line ending for expected output of host executables.
 m4_define([LT_AT_HOST_DATA],
 [AT_DATA([$1], [$2])
-case $host_os in mingw* | windows*)
-  awk '{printf ("%s\r\n", [$]0);}' < $1 > $1.t && mv -f $1.t $1 ;;
+case $host_os,$build_os in
+cygwin*,*|mingw*,cygwin*)
+  awk '{printf ("%s\n", [$]0);}' < $1 > $1.t && mv -f $1.t $1;;
+mingw*,*|windows*,*)
+  awk '{printf ("%s\r\n", [$]0);}' < $1 > $1.t && mv -f $1.t $1;;
 esac])
 
 
-- 
2.45.2

